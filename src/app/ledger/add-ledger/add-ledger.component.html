<div class=" container-fluid  mt-3">
  <form [formGroup]="ledgerForm" (ngSubmit)="onSubmitForm(ledgerForm.value)">
    <div class="row">
      <div class="col-md-6 mb-3">
        <label class="form-label" for="text">Ledger Name</label>
        <input type="text" class="form-control client-field" maxLength="150" id="name" formControlName="name"
          [class.is-invalid]="f['name'].invalid && f['name'].touched ">
        <div class="invalid-feedback mt-0" *ngIf="f['name'].invalid && f['name'].touched ">
          <div *ngIf="f['name'].errors && f['name'].errors['required']">
            Ledger name is required
          </div>
          <div *ngIf="f['name'].errors && f['name'].errors['minlength']">
            Minimum 3 character is rquired in Ledger name
          </div>
          <div *ngIf="f['name'].errors  && f['name'].errors['pattern']">
            Only character is allowed
          </div>
        </div>
      </div>
      <div class="col-md-6 mb-3">
        <label class="form-label" for="text">Year</label>
        <input type="text" class="form-control client-field" maxLength="150" id="amount" formControlName="year"
          [class.is-invalid]="f['year'].invalid && f['year'].touched ">
        <div class="invalid-feedback mt-0" *ngIf="f['year'].invalid && f['year'].touched ">
          <div *ngIf="f['year'].errors && f['year'].errors['required']">
            Year is required
          </div>
          <div *ngIf="f['year'].errors && f['year'].errors['pattern']">
            Only number is allowed
          </div>
          <div *ngIf="f['year'].errors && f['year'].errors['minlength']">
            Minimum 4 digit is required
          </div>
        </div>
      </div>
    </div>
    <table class="table table-bordered">
      <thead class="table-light">
        <tr>
          <th>Description</th>
          <th>Credit</th>
          <th>Debit</th>
          <th>Date</th>
          <th>
            Action
          </th>
        </tr>
      </thead>
      <tbody formArrayName="ledgerquantities">
        <tr *ngFor="let quantity of quantities().controls; let i=index" [formGroupName]="i">
          <td>
            <input type="text" formControlName="description" class="form-control text" placeholder="Enter Description"
              [class.is-invalid]="quantities().controls[i].get('description')?.invalid && quantities().controls[i].get('description')?.touched">
            <div class="invalid-feedback mt-0"
              *ngIf="quantities().controls[i].get('description')?.invalid && quantities().controls[i].get('description')?.touched ">
              <div
                *ngIf="quantities().controls[i].get('description')?.errors && quantities().controls[i].get('description')?.errors?.['required'] ">
                Ledger description is required
              </div>
              <div
                *ngIf="quantities().controls[i].get('description')?.errors && quantities().controls[i].get('description')?.errors?.['minlength'] ">
                minimum c char is required
              </div>
            </div>
          </td>
          <td>
            <input type="text" formControlName="credit" class="form-control" (keyup)="onKeyPressCredit($event, i)"
              [class.is-invalid]="quantities().controls[i].get('credit')?.invalid && quantities().controls[i].get('credit')?.touched">

            <div class="invalid-feedback mt-0"
              *ngIf="quantities().controls[i].get('credit')?.invalid && quantities().controls[i].get('credit')?.touched ">
              <div
                *ngIf="quantities().controls[i].get('credit')?.errors && quantities().controls[i].get('credit')?.errors?.['required'] ">
                Credit is required
              </div>
              <div
                *ngIf="quantities().controls[i].get('credit')?.errors && quantities().controls[i].get('credit')?.errors?.['pattern'] ">
                Only Number is allowed
              </div>
            </div>
          </td>
          <td>

            <input type="text" formControlName="debit" class="form-control" (keyup)="onKeyPressDebit($event, i)"
              [class.is-invalid]="quantities().controls[i].get('debit')?.invalid && quantities().controls[i].get('debit')?.touched">
            <div class="invalid-feedback mt-0"
              *ngIf="quantities().controls[i].get('debit')?.invalid && quantities().controls[i].get('debit')?.touched ">
              <div
                *ngIf="quantities().controls[i].get('debit')?.errors && quantities().controls[i].get('debit')?.errors?.['required'] ">
                Debit is required
              </div>
              <div
                *ngIf="quantities().controls[i].get('debit')?.errors && quantities().controls[i].get('debit')?.errors?.['pattern'] ">
                Only Number is allowed
              </div>
            </div>
          </td>
          <td>
            <input type="date" formControlName="date" class="form-control"
              [class.is-invalid]="quantities().controls[i].get('date')?.invalid && quantities().controls[i].get('date')?.touched">
            <div class="invalid-feedback mt-0"
              *ngIf="quantities().controls[i].get('date')?.invalid && quantities().controls[i].get('date')?.touched ">
              <div
                *ngIf="quantities().controls[i].get('date')?.errors && quantities().controls[i].get('date')?.errors?.['required'] ">
                Date is required
              </div>
            </div>

          </td>
          <td>
            <button type="button" class="btn btn-primary plus" (click)="addQuantity()">+</button>
            <button type="button" (click)="removeRow(i)" class="btn btn-danger minus">-</button>
          </td>
        </tr>

      </tbody>
      <thead>
        <tr>
          <th>Profit/Loss</th>
          <th *ngIf="debitSum>creditSum ;else other_content ">
            <input type="number" formControlName="loss" name="loss" class="form-control" [(ngModel)]="ledgerLost"
              readonly>
          </th>
          <ng-template #other_content>
            <th>
              <input type="text" value="0" class="form-control">
            </th>
          </ng-template>
          <th *ngIf="creditSum>debitSum ;else other_content">
            <input type="number" formControlName="profit" name="profit" class="form-control" [(ngModel)]="ledgerProfit"
              readonly>
          </th>
          <th></th>
          <th></th>
        </tr>
        <tr>
          <th>Tottal</th>
          <th>
            <input type="number" formControlName="creditSum" name="creditSum" class="form-control" readonly>
          </th>
          <th>
            <input type="number" formControlName="creditSum" name="creditSum" class="form-control" readonly>
          </th>
          <th></th>
          <th></th>
        </tr>
      </thead>
    </table>

    <div class="row">
      <div class="col-md-6">
        <button type="submit" class="btn btn-primary" [class.disabled]="ledgerForm.invalid">Save</button>
      </div>
    </div>
  </form>
</div>